<html lang="en">
  <head>
    <meta charset="utf-8" />
	<link rel="icon" type="image/x-icon" href="src/img/logo.ico"/>
    <title>脱单指数测试</title>
  </head>
  <body>
  <iframe id="id_iframe" name="nm_iframe" style="display:none;"></iframe>    
  <canvas id="share" width="400" height="600" hidden></canvas>
  <div id='test'>
  <img id='bg' src='src/img/background.jpg' style='z-index:-1;position:absolute;top:0;left:0;width:100%;height:auto;'/>
  
  <img id='onetrue1' src='src/img/button.png' onclick="onetrue()" style='z-index:1;position:absolute;left:18%;width:10%'/>
  <img id='onetrue2' src='src/img/buttonred.png' hidden style='z-index:1;position:absolute;left:18%;width:10%'/>
  <img id='onefalse1' src='src/img/button.png' onclick="onefalse()" style='z-index:1;position:absolute;left:42%;width:10%'/>
  <img id='onefalse2' src='src/img/buttonred.png' hidden style='z-index:1;position:absolute;left:42%;width:10%'/>
  
  <img id='twotrue1' src='src/img/button.png' onclick="twotrue()" style='z-index:1;position:absolute;left:27%;width:10%'/>
  <img id='twotrue2' src='src/img/buttonred.png' hidden style='z-index:1;position:absolute;left:27%;width:10%'/>
  <img id='twofalse1' src='src/img/button.png' onclick="twofalse()" style='z-index:1;position:absolute;left:57%;width:10%'/>
  <img id='twofalse2' src='src/img/buttonred.png' hidden style='z-index:1;position:absolute;left:57%;width:10%'/>
  
  <img id='three1' src='src/img/button.png' data-index="1" onclick="three(this)" style='z-index:1;position:absolute;left:10%;width:9%'/>
  <img id='three1on' src='src/img/buttonred.png' data-index="1" onclick="three(this)" hidden style='z-index:1;position:absolute;left:10%;width:9%'/>
  <img id='three2' src='src/img/button.png' data-index="2" onclick="three(this)" style='z-index:1;position:absolute;left:17%;width:9%'/>
  <img id='three2on' src='src/img/buttonred.png' data-index="2" onclick="three(this)" hidden style='z-index:1;position:absolute;left:17%;width:9%'/>
  <img id='three3' src='src/img/button.png' data-index="3" onclick="three(this)" style='z-index:1;position:absolute;left:24%;width:9%'/>
  <img id='three3on' src='src/img/buttonred.png' data-index="3" onclick="three(this)" hidden style='z-index:1;position:absolute;left:24%;width:9%'/>
  <img id='three4' src='src/img/button.png' data-index="4" onclick="three(this)" style='z-index:1;position:absolute;left:31%;width:9%'/>
  <img id='three4on' src='src/img/buttonred.png' data-index="4" onclick="three(this)" hidden style='z-index:1;position:absolute;left:31%;width:9%'/>
  <img id='three5' src='src/img/button.png' data-index="5" onclick="three(this)" onclick="twotrue()" style='z-index:1;position:absolute;left:38%;width:9%'/>
  <img id='three5on' src='src/img/buttonred.png' data-index="5" onclick="three(this)" hidden style='z-index:1;position:absolute;left:38%;width:9%'/>
  <img id='three6' src='src/img/button.png' data-index="6" onclick="three(this)" style='z-index:1;position:absolute;left:45%;width:9%'/>
  <img id='three6on' src='src/img/buttonred.png' data-index="6" onclick="three(this)" hidden style='z-index:1;position:absolute;left:45%;width:9%'/>
  <img id='three7' src='src/img/button.png' data-index="7" onclick="three(this)" style='z-index:1;position:absolute;left:52%;width:9%'/>
  <img id='three7on' src='src/img/buttonred.png' data-index="7" onclick="three(this)" hidden style='z-index:1;position:absolute;left:52%;width:9%'/>
  <img id='three8' src='src/img/button.png' data-index="8" onclick="three(this)" style='z-index:1;position:absolute;left:59%;width:9%'/>
  <img id='three8on' src='src/img/buttonred.png' data-index="8" onclick="three(this)" hidden style='z-index:1;position:absolute;left:59%;width:9%'/>
  <img id='three9' src='src/img/button.png' data-index="9" onclick="three(this)" style='z-index:1;position:absolute;left:66%;width:9%'/>
  <img id='three9on' src='src/img/buttonred.png' data-index="9" onclick="three(this)" hidden style='z-index:1;position:absolute;left:66%;width:9%'/>
  <img id='three10' src='src/img/button.png' data-index="10" onclick="three(this)" style='z-index:1;position:absolute;left:73%;width:9%'/>
  <img id='three10on' src='src/img/buttonred.png' data-index="10" onclick="three(this)" hidden style='z-index:1;position:absolute;left:73%;width:9%'/>
  
  <img id='four1' src='src/img/button.png' data-index="1" onclick="four(this)" style='z-index:1;position:absolute;left:18%;width:9%'/>
  <img id='four1on' src='src/img/buttonred.png' data-index="1" onclick="four(this)" hidden style='z-index:1;position:absolute;left:18%;width:9%'/>
  <img id='four2' src='src/img/button.png' data-index="2" onclick="four(this)" style='z-index:1;position:absolute;left:25%;width:9%'/>
  <img id='four2on' src='src/img/buttonred.png' data-index="2" onclick="four(this)" hidden style='z-index:1;position:absolute;left:25%;width:9%'/>
  <img id='four3' src='src/img/button.png' data-index="3" onclick="four(this)" style='z-index:1;position:absolute;left:32%;width:9%'/>
  <img id='four3on' src='src/img/buttonred.png' data-index="3" onclick="four(this)" hidden style='z-index:1;position:absolute;left:32%;width:9%'/>
  <img id='four4' src='src/img/button.png' data-index="4" onclick="four(this)" style='z-index:1;position:absolute;left:39%;width:9%'/>
  <img id='four4on' src='src/img/buttonred.png' data-index="4" onclick="four(this)" hidden style='z-index:1;position:absolute;left:39%;width:9%'/>
  <img id='four5' src='src/img/button.png' data-index="5" onclick="four(this)" onclick="twotrue()" style='z-index:1;position:absolute;left:46%;width:9%'/>
  <img id='four5on' src='src/img/buttonred.png' data-index="5" onclick="four(this)" hidden style='z-index:1;position:absolute;left:46%;width:9%'/>
  <img id='four6' src='src/img/button.png' data-index="6" onclick="four(this)" style='z-index:1;position:absolute;left:53%;width:9%'/>
  <img id='four6on' src='src/img/buttonred.png' data-index="6" onclick="four(this)" hidden style='z-index:1;position:absolute;left:53%;width:9%'/>
  <img id='four7' src='src/img/button.png' data-index="7" onclick="four(this)" style='z-index:1;position:absolute;left:60%;width:9%'/>
  <img id='four7on' src='src/img/buttonred.png' data-index="7" onclick="four(this)" hidden style='z-index:1;position:absolute;left:60%;width:9%'/>
  <img id='four8' src='src/img/button.png' data-index="8" onclick="four(this)" style='z-index:1;position:absolute;left:67%;width:9%'/>
  <img id='four8on' src='src/img/buttonred.png' data-index="8" onclick="four(this)" hidden style='z-index:1;position:absolute;left:67%;width:9%'/>
  <img id='four9' src='src/img/button.png' data-index="9" onclick="four(this)" style='z-index:1;position:absolute;left:74%;width:9%'/>
  <img id='four9on' src='src/img/buttonred.png' data-index="9" onclick="four(this)" hidden style='z-index:1;position:absolute;left:74%;width:9%'/>
  <img id='four10' src='src/img/button.png' data-index="10" onclick="four(this)" style='z-index:1;position:absolute;left:81%;width:9%'/>
  <img id='four10on' src='src/img/buttonred.png' data-index="10" onclick="four(this)" hidden style='z-index:1;position:absolute;left:81%;width:9%'/>
  
  <img id='five' src='src/img/button.png' style='z-index:1;position:absolute;left:53%;width:30%'/>
  <input id='gpa' style='z-index:1;position:absolute;left:58%;background-color:transparent;width:20%;height:100px;line-height:100px;font-size:40;text-align:center;border:none'>
  
  <img id='six1' src='src/img/button.png' data-index="1" onclick="six(this)" style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six1on' src='src/img/buttonred.png' data-index="1" onclick="six(this)" hidden style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six2' src='src/img/button.png' data-index="2" onclick="six(this)" style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six2on' src='src/img/buttonred.png' data-index="2" onclick="six(this)" hidden style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six3' src='src/img/button.png' data-index="3" onclick="six(this)" style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six3on' src='src/img/buttonred.png' data-index="3" onclick="six(this)" hidden style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six4' src='src/img/button.png' data-index="4" onclick="six(this)" style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six4on' src='src/img/buttonred.png' data-index="4" onclick="six(this)" hidden style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six5' src='src/img/button.png' data-index="5" onclick="six(this)" onclick="twotrue()" style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six5on' src='src/img/buttonred.png' data-index="5" onclick="six(this)" hidden style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six6' src='src/img/button.png' data-index="6" onclick="six(this)" style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six6on' src='src/img/buttonred.png' data-index="6" onclick="six(this)" hidden style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six7' src='src/img/button.png' data-index="7" onclick="six(this)" style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six7on' src='src/img/buttonred.png' data-index="7" onclick="six(this)" hidden style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six8' src='src/img/button.png' data-index="8" onclick="six(this)" style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six8on' src='src/img/buttonred.png' data-index="8" onclick="six(this)" hidden style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six9' src='src/img/button.png' data-index="9" onclick="six(this)" style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six9on' src='src/img/buttonred.png' data-index="9" onclick="six(this)" hidden style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six10' src='src/img/button.png' data-index="10" onclick="six(this)" style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six10on' src='src/img/buttonred.png' data-index="10" onclick="six(this)" hidden style='z-index:1;position:absolute;left:79%;width:9%'/>
  <img id='six11' src='src/img/button.png' data-index="11" onclick="six(this)" style='z-index:1;position:absolute;left:37%;width:9%'/>
  <img id='six11on' src='src/img/buttonred.png' data-index="11" onclick="six(this)" hidden style='z-index:1;position:absolute;left:37%;width:9%'/>

  <img id='submit' src='src/img/submit.png' onclick="startTest()" style='z-index:1;position:absolute;margin-left:27.5%;width:45%'/>
  
  </div>
  <div id='res' align='center' style='margin-left:5%;margin-right:5%' hidden>
    <img src='src/img/res.jpg' style='z-index:-1;position:absolute;top:0;left:0;width:100%;height:auto;'/>
	<div id='grade' style='z-index:1;position:absolute;left:39%;color:white;font-size:90px'></div>
	<img id='resbutton1' onClick="makefriend()" src='src/img/resbutton1.png' style='z-index:1;position:absolute;left:30%;width:40%;'/>
	<img id='resbutton2' onClick="refresh()" src='src/img/resbutton2.png' style='z-index:1;position:absolute;left:30%;width:40%;'/>
	<img id='resbutton3' onClick="share()" src='src/img/resbutton3.png' style='z-index:1;position:absolute;left:30%;width:40%;'/>
  </div>
  <div id='sharediv' align='center' style='margin-left:5%;margin-right:5%' hidden>
    <center><img id='sharepic' src='' style='width:400px;height:600px;'/></center>
	<div>长按图片即可保存并分享</div>
	<br />
	<br />
	<center><button onClick="back()">返回</button></center>
  </div>
  <div id='friend' align='center' style='margin-left:5%;margin-right:5%' hidden>
    <form action="" method="post" target="nm_iframe" id='form2'>
	  <div align='left' style='display:inline-block'>
	    你的性别
		<br />
		男：
        <input type="radio" name="sex" value="男" />
        女：
        <input type="radio" name="sex" value="女" />
		<br />
		<br />
		你的微信号
		<br />
		<input type="text" name="wechat"/>
		<br />
		<br />
		匹配类型
		<br />
		脱单指数最高的：
        <input type="radio" name="type" value="1" />
		<br />
        脱单指数和我最接近的：
        <input type="radio" name="type" value="0" />
		<br />
		<br />
		<div align='center'>
	      <input type="submit" value="开始匹配" onclick="startMatch()"/>
	    </div>
	  </div>
	</form>
  </div>
  <div id='match' align='center' style='margin-left:5%;margin-right:5%' hidden>
    匹配中...
  </div>
  </body>
</html>
<script type="text/javascript" src="src/js/Bmob-1.6.3.min.js"></script>
<script type="text/javascript" src="src/js/html2canvas.min.js"></script>
<script type="text/javascript">
  document.getElementById('onetrue1').style.top=0.288*document.body.scrollHeight;
  document.getElementById('onetrue2').style.top=0.288*document.body.scrollHeight;
  document.getElementById('onefalse1').style.top=0.288*document.body.scrollHeight;
  document.getElementById('onefalse2').style.top=0.288*document.body.scrollHeight;
  
  document.getElementById('twotrue1').style.top=0.38*document.body.scrollHeight;
  document.getElementById('twotrue2').style.top=0.38*document.body.scrollHeight;
  document.getElementById('twofalse1').style.top=0.38*document.body.scrollHeight;
  document.getElementById('twofalse2').style.top=0.38*document.body.scrollHeight;
  
  document.getElementById('three1').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three2').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three3').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three4').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three5').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three6').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three7').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three8').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three9').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three10').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three1on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three2on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three3on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three4on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three5on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three6on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three7on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three8on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three9on').style.top=0.47*document.body.scrollHeight;
  document.getElementById('three10on').style.top=0.47*document.body.scrollHeight;
  
  document.getElementById('four1').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four2').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four3').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four4').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four5').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four6').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four7').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four8').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four9').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four10').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four1on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four2on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four3on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four4on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four5on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four6on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four7on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four8on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four9on').style.top=0.532*document.body.scrollHeight;
  document.getElementById('four10on').style.top=0.532*document.body.scrollHeight;
  
  document.getElementById('five').style.top=0.6*document.body.scrollHeight;
  document.getElementById('gpa').style.top=0.63*document.body.scrollHeight;
  
  document.getElementById('six1').style.top=0.715*document.body.scrollHeight;
  document.getElementById('six2').style.top=0.715*document.body.scrollHeight;
  document.getElementById('six3').style.top=0.736*document.body.scrollHeight;
  document.getElementById('six4').style.top=0.736*document.body.scrollHeight;
  document.getElementById('six5').style.top=0.759*document.body.scrollHeight;
  document.getElementById('six6').style.top=0.759*document.body.scrollHeight;
  document.getElementById('six7').style.top=0.782*document.body.scrollHeight;
  document.getElementById('six8').style.top=0.782*document.body.scrollHeight;
  document.getElementById('six9').style.top=0.805*document.body.scrollHeight;
  document.getElementById('six10').style.top=0.805*document.body.scrollHeight;
  document.getElementById('six11').style.top=0.828*document.body.scrollHeight;
  document.getElementById('six1on').style.top=0.715*document.body.scrollHeight;
  document.getElementById('six2on').style.top=0.715*document.body.scrollHeight;
  document.getElementById('six3on').style.top=0.736*document.body.scrollHeight;
  document.getElementById('six4on').style.top=0.736*document.body.scrollHeight;
  document.getElementById('six5on').style.top=0.759*document.body.scrollHeight;
  document.getElementById('six6on').style.top=0.759*document.body.scrollHeight;
  document.getElementById('six7on').style.top=0.782*document.body.scrollHeight;
  document.getElementById('six8on').style.top=0.782*document.body.scrollHeight;
  document.getElementById('six9on').style.top=0.805*document.body.scrollHeight;
  document.getElementById('six10on').style.top=0.805*document.body.scrollHeight;
  document.getElementById('six11on').style.top=0.828*document.body.scrollHeight;
  
  document.getElementById('submit').style.top=0.88*document.body.scrollHeight;
  
  var TD,APP,HAP,INC,GPA,STFC,res;
  var cxt=document.getElementById("share").getContext("2d");
  cxt.fillStyle='#FFFFFF';
  cxt.fillRect(0,0,400,600);
  cxt.fillStyle='#000000';
  var code = new Image();
  code.src = 'src/img/code.png';
  code.onload=function(){
    cxt.drawImage(code,260,460,100,100);
	cxt.textAlign='center';
    cxt.font="normal normal normal 10px Arial"
    cxt.fillText("扫码体验" ,310, 575);
  }
  Bmob.initialize("7f518700e53363110974536ce2d479fb", "a7bdd090a38a53c3487cb57c00e6cd8f");
  function onetrue(){
    TD=1;
    document.getElementById('onetrue1').style.display='none';
	document.getElementById('onetrue2').style.display='inline';
	document.getElementById('onefalse2').style.display='none';
	document.getElementById('onefalse1').style.display='inline';
  }
  function onefalse(){
    TD=0;
    document.getElementById('onefalse1').style.display='none';
	document.getElementById('onefalse2').style.display='inline';
	document.getElementById('onetrue2').style.display='none';
	document.getElementById('onetrue1').style.display='inline';
  }
  function twotrue(){
    STFC=1;
    document.getElementById('twotrue1').style.display='none';
	document.getElementById('twotrue2').style.display='inline';
	document.getElementById('twofalse2').style.display='none';
	document.getElementById('twofalse1').style.display='inline';
  }
  function twofalse(){
    STFC=0;
    document.getElementById('twofalse1').style.display='none';
	document.getElementById('twofalse2').style.display='inline';
	document.getElementById('twotrue2').style.display='none';
	document.getElementById('twotrue1').style.display='inline';
  }
  function three(e){
	var num=parseInt(e.getAttribute("data-index"))
	HAP=Math.log(num) / Math.log(10);
	for(var i=1;i<=10;i++){
	   if(i<=num){
	     document.getElementById('three'+i).style.display='none';
		 document.getElementById('three'+i+'on').style.display='inline';
	   }
	   else{
	     document.getElementById('three'+i).style.display='inline';
		 document.getElementById('three'+i+'on').style.display='none';
	   }
	}
  }
  function four(e){
	var num=parseInt(e.getAttribute("data-index"))
	APP=Math.log(num) / Math.log(10);
	for(var i=1;i<=10;i++){
	   if(i<=num){
	     document.getElementById('four'+i).style.display='none';
		 document.getElementById('four'+i+'on').style.display='inline';
	   }
	   else{
	     document.getElementById('four'+i).style.display='inline';
		 document.getElementById('four'+i+'on').style.display='none';
	   }
	}
  }
  function six(e){
	var num=parseInt(e.getAttribute("data-index"))
	INC=Math.log(num) / Math.log(10);
	for(var i=1;i<=11;i++){
	   if(i==num){
	     document.getElementById('six'+i).style.display='none';
		 document.getElementById('six'+i+'on').style.display='inline';
	   }
	   else{
	     document.getElementById('six'+i).style.display='inline';
		 document.getElementById('six'+i+'on').style.display='none';
	   }
	}
  }
  function startTest(){ //计算脱单指数
    var grade=document.getElementById('gpa').value;
	if(TD==undefined){
	  alert("请选择是否脱单！")
	}
	else if(STFC==undefined){
	  alert("请选择是否关注公众号“同济吃货小分队”！")
	}
	else if(HAP==undefined){
	  alert("请给自己的幸福指数打分！")
	}
	else if(APP==undefined){
	  alert("请给自己的颜值打分！")
	}
	else if(!grade){
	  alert("请输入您的绩点！")
	}
	else if(parseFloat(grade)<=0||parseFloat(grade)>5){
	  alert("输入的绩点有误！")
	}
	else if(INC==undefined){
	  alert("请选择您的月均生活费！")
	}
	else{
	  GPA=Math.log(parseFloat(grade)) / Math.log(5);
	  res=(0.33*APP+0.30*HAP+0.15*INC+0.11*GPA+0.1*STFC)/0.99621;
	  document.getElementById('test').style.display='none';
	  document.getElementById('res').style.display='inline';
	  document.getElementById('grade').innerHTML=res.toFixed(3);
	  document.getElementById('grade').style.top=0.34*document.body.scrollHeight;
      document.getElementById('resbutton1').style.top=0.48*document.body.scrollHeight;
      document.getElementById('resbutton2').style.top=0.57*document.body.scrollHeight;
      document.getElementById('resbutton3').style.top=0.66*document.body.scrollHeight;
	  window.scrollTo(0,0)
	}
  }
  function refresh(){ //重新测试
    window.location.reload()
  }
  function share(){ //转发分享函数
    cxt.font = "normal normal bold 30px Arial";
    cxt.fillText("我的脱单指数为"+res.toFixed(3) ,200, 150);
    cxt.font = "normal normal normal 20px Arial";
	if(res>=0&&res<0.1){
	  cxt.fillText("或许你应该自信点儿 (•̀ω•́)✧" ,200, 300);
	}
	else if(res>=0.1&&res<0.2){
	  cxt.fillText("不找了～找不到了～" ,200, 300);
	}
	else if(res>=0.2&&res<0.3){
	  cxt.fillText("或许关注久了颜值就能提高吧 (•͈˽•͈)" ,200, 300);
	}
	else if(res>=0.3&&res<0.4){
	  cxt.fillText("我这叫凭实力单身" ,200, 300);
	}
	else if(res>=0.4&&res<0.5){
	  cxt.fillText("dbq你拖了吃货们的后腿 (ಥ_ಥ)" ,200, 300);
	}
	else if(res>=0.5&&res<0.6){
	  cxt.fillText("耶！你高于人均水平了 (•̀ω•́)✧" ,200, 300);
	}
	else if(res>=0.6&&res<0.7){
	  cxt.fillText("我觉得你低估了自己的颜值 (๑•́₃•̀๑)" ,200, 300);
	}
	else if(res>=0.7&&res<0.8){
	  cxt.fillText("哇塞！优秀的同学请你坐下 (∩ᵒ̴̶̷̤⌔ᵒ̴̶̷̤∩)" ,200, 300);
	}
	else if(res>=0.8&&res<0.9){
	  cxt.fillText("你离脱单只差1、、呢 (•̀ω•́)✧" ,200, 300);
	}
	else if(res>=0.9&&res<=1){
	  cxt.fillText("千年一遇！！这种人还不脱单？？？" ,200, 300);
	}
	var share = document.getElementById("share");
    var image = share.toDataURL("image/png");
    document.getElementById('res').style.display='none';
	document.getElementById('sharepic').src=image;
	document.getElementById('sharediv').style.display='inline';
  }
  function back(){  //返回
    document.getElementById('sharediv').style.display='none';
	document.getElementById('res').style.display='inline';
  }
  function makefriend(){  //我要脱单
    document.getElementById('res').style.display='none';
	document.getElementById('friend').style.display='inline';
  }
  function startMatch(){  //脱单匹配函数
    var form = document.getElementById("form2");
	if(!form.elements.sex.value){
	  alert("请选择您的性别！")
	}
	else if(!form.elements.wechat.value){
	  alert("请选择您的微信号！")
	}
	else if(!form.elements.type.value){
	  alert("请选择您要匹配的类型！")
	}
	else{
	  document.getElementById('friend').style.display='none';
	  document.getElementById('match').style.display='inline';
	  if(form.elements.type.value=='1'){
	    var query = Bmob.Query("test");
		query.equalTo("sex","==", (form.elements.sex.value=='男'?'女':'男'));
		query.equalTo("num","<", 3);
		query.order("-res");
		query.limit(1);
		query.find().then(res => {
			document.getElementById('match').innerHTML="经过匹配，您最有缘的对象的微信号是："+res[0].wechat+"，"+(form.elements.sex.value=='男'?'她':'他')+"的脱单指数是："+res[0].res.toFixed(3)+"，快去联系"+(form.elements.sex.value=='男'?'她':'他')+"吧！"
			var query = Bmob.Query('test');
			query.get(results[0].objectId).then(res => {
				res.set('num',res.num+1)
				res.save()
			}).catch(err => {
				console.log(err)
			})
		});
	  }
	  else if(form.elements.type.value=='0'){
	    var query = Bmob.Query("test");
		query.equalTo("sex","==", (form.elements.sex.value=='男'?'女':'男'));
		query.equalTo("num","<", 3);
		query.order("-res");
		query.limit(1000);
		query.find().then(results => {
		    if(res>=results[0].res){
			    document.getElementById('match').innerHTML="经过匹配，您最有缘的对象的微信号是："+results[0].wechat+"，"+(form.elements.sex.value=='男'?'她':'他')+"的脱单指数是："+results[0].res.toFixed(3)+"，快去联系"+(form.elements.sex.value=='男'?'她':'他')+"吧！"
				var query = Bmob.Query('test');
				query.get(results[0].objectId).then(res => {
					res.set('num',res.num+1)
					res.save()
				}).catch(err => {
					console.log(err)
				})
			}
			else if(res<=results[results.length-1].res){
			    document.getElementById('match').innerHTML="经过匹配，您最有缘的对象的微信号是："+results[results.length-1].wechat+"，"+(form.elements.sex.value=='男'?'她':'他')+"的脱单指数是："+results[results.length-1].res.toFixed(3)+"，快去联系"+(form.elements.sex.value=='男'?'她':'他')+"吧！"
				var query = Bmob.Query('test');
				query.get(results[results.length-1].objectId).then(res => {
					res.set('num',res.num+1)
					res.save()
				}).catch(err => {
					console.log(err)
				})
			}
			else{
				for(var i=0;i<results.length-1;i++){
					if(results[i].res>=res&&results[i+1].res<=res){
						if((results[i].res-res)<=(res-results[i+1].res)){
							document.getElementById('match').innerHTML="经过匹配，您最有缘的对象的微信号是："+results[i].wechat+"，"+(form.elements.sex.value=='男'?'她':'他')+"的脱单指数是："+results[i].res.toFixed(3)+"，快去联系"+(form.elements.sex.value=='男'?'她':'他')+"吧！"
							var query = Bmob.Query('test');
							query.get(results[i].objectId).then(res => {
								res.set('num',res.num+1)
								res.save()
							}).catch(err => {
								console.log(err)
							})
						}
						else{
							document.getElementById('match').innerHTML="经过匹配，您最有缘的对象的微信号是："+results[i+1].wechat+"，"+(form.elements.sex.value=='男'?'她':'他')+"的脱单指数是："+results[i+1].res.toFixed(3)+"，快去联系"+(form.elements.sex.value=='男'?'她':'他')+"吧！"
							var query = Bmob.Query('test');
							query.get(results[i+1].objectId).then(res => {
								res.set('num',res.num+1)
								res.save()
							}).catch(err => {
								console.log(err)
							})
						}
						break;
					}
				}
			}
		});
	  }
	  var query = Bmob.Query('test');
	  query.set("APP",APP)
	  query.set("HAP",HAP)
	  query.set("INC",INC)
	  query.set("GPA",GPA)
	  query.set("STFC",STFC)
	  query.set("res",res)
	  query.set("sex",form.elements.sex.value)
	  query.set("wechat",form.elements.wechat.value)
	  query.set("num",0)
	  query.save().then(res => {
	    console.log(res)
	  }).catch(err => {
        console.log(err)
	  })
	}
  }
</script>